#!/usr/bin/env bash
#### Smartpad Specific Tweaks for armbian images
####
#### Written by Stephan Wendel aka KwadFan <me@stephanwe.de>
#### Copyright 2023 - till today
#### https://github.com/KwadFan
####
#### This File is distributed under GPLv3
####

# shellcheck enable=require-variable-braces
# Source error handling, leave this in place
set -Ee

# Source CustomPIOS common.sh
# shellcheck disable=SC1091
source /common.sh
install_cleanup_trap

echo_green "Install Docker ..."
curl -sSL https://get.docker.com | sh
sudo usermod -aG docker "${BASE_USER}"
echo_green "Install Docker ...(DONE)"
echo_green "Install lib ..."
sudo apt install libffi-dev libssl-dev python3-dev -y
sudo apt install python3 python3-pip -y
sudo pip3 install docker-compose --break-system-packages
echo_green "Install lib ...(DONE)"
echo_green "Enable Docker ..."
sudo systemctl enable docker
echo_green "Enable Docker ...(DONE)"
echo_green "Create Folder ..."
mkdir docker
cd docker
mkdir homeAssistant
cd homeAssistant
echo_green "Create Folder ...(DONE)"
echo_green "Compose Home Assistant ..."
sudo docker-compose up -d
echo_green "Compose Home Assistant ...(DONE)"
